services:
  db2:
    ports:
      - "3306:3306"
    volumes:
      - ./logs/db:/var/www/html/storage/logs

  api:
    volumes:
      - ./api/src:/work/src
      - ./logs/api:/work/logs
      - ./config:/config:ro
      - ./scripts:/scripts:ro
    ports:
      - "8010:80"
    environment:
      DEV_RUN: "true"
      TEST_SERVICE_TOKEN:

  email-dispatcher:
    volumes:
      - ./api/src:/work/src
      - ./logs/email_dispatcher:/work/logs
      - ./config:/config:ro
      - ./scripts:/scripts:ro
    environment:
      DEV_RUN: "true"

  accessy-syncer:
    volumes:
      - ./api/src:/work/src
      - ./logs/accessy_syncer:/work/logs
    environment:
      DEV_RUN: "true"

  public:
    build:
      args:
        DEV_BUILD: "true"
    ports:
      - "8011:80"
    volumes:
      - ./public/ts:/work/ts
      - ./public/scss:/work/scss
      - ./public/src:/work/src
      - ./frontend_common/src:/frontend_common/src
      - ./config:/config:ro
      - ./scripts:/scripts:ro
    environment:
      DEV_RUN: "true"

  admin:
    build:
      dockerfile: DevServerDockerfile
    ports:
      - "8009:80"
    volumes:
      - ./admin/src:/work/src
      - ./admin/dist:/work/dist
      - ./frontend_common/src:/frontend_common/src
    environment:
      DEV_RUN: "true"
